## MySQL体系结构

客户端连接器，MySQL Server

MySQL Server

- 连接层：处理客户端连接
- 服务层（SQL接口、解析器、查询优化器、缓存）
- 引擎层（可插拔存储引擎）
- 存储层

![image-20240325200528912](./images/image-20240325200528912.png)

![image-20240325200535401](./images/image-20240325200535401.png)

## 简介

> 什么是存储引擎？如何指定存储引擎？
>
> 存储引擎是存储数据、建立索引、更新查询数据等技术的实现方式

存储引擎是基于表的
查询建表语句`show create table 表名`
查询数据库支持的存储引擎`show engines`

默认`ENGINE=InnoDB`

## 特点

### InnoDB

1. DML操作遵循ACID模型，支持**事务**
2. **行级锁**，提高并发访问性能
3. 支持**外键**约束

表空间文件`xxx.ibd`
存储表的结构、数据、索引、innodb_file_per_table(ON->每张表对应一个表空间)
查看表结构`ibd2sdi xxx.ibd`

逻辑存储结构

- TableSpece表空间
- Segment段
- Extent区(大小1，包含64页)
- Page页(磁盘操作的最小单元、大小16k)
- Row行

 ![image-20240325202503339](./images/image-20240325202503339.png)

![image-20240325202515859](./images/image-20240325202515859.png)



![image-20240325204040399](./images/image-20240325204040399.png)

### MyISAM

1. 不支持事务和外键
2. 支持表锁，不支持行锁
3. 访问速度快

表结构`.sdi`
数据`.MYD`
索引`.MYI`

### Memory

1. 内存存放，速度快，但是只能用作临时表
2. 支持hash索引

表结构`sdi`

## 选择

根据系统特点和需求选择

**InnoDB**：对事务完整性一致性要求比较高
MyISAM：以读取和插入为主，很少更新和删除，不要求事务的完整性和并发性，被。。。替代
MEMORY：缓存，对表的大小有限制，无法保障数据安全性，被Redis替代