# 汇编

## 基本概念

本课程以8086CPU作为平台

### 组成

1. 汇编指令
2. 伪指令
3. 其他符号

### 通用寄存器

8086所有寄存器都是16位=2个字节=4个16进制位
通用寄存器：AX、BX、CX、DX，存放一般性数据
AX-> AH、AL：每个通用寄存器可以分为 **2个独立的**8位寄存器使用



## DOSBox使用

启动

```shell
mount c o:masm
c:
debug
-r//显示
-a//开始写代码
xxx
-t//执行刚才写的一行代码
```



## debug instructions(true ad)

### register 寄存器

`r`查看 或 改变CPU寄存器
`r ax` 修改axCPU寄存器

### assemble 汇编

`a CS:IP`写入汇编指令

`a 2000:0013`在指定内存的位置写入汇编指令

> `-a`之后可以输入n行指令，然后依次输入`t`就可以依次执行 

### display 显示

`d [地址] n`查看某个地址中n个数，n用16进制表示
`d [地址]` 查看内存内容

### enter 输入

`e [地址] 值`改变内存内容，如果不输入值，那么可以依次修改

### trace 跟踪(执行一步)

`t`单步执行
`G`运行

> 每次t之后，会显示下一次输入t之后执行的指令  

### unassemble 反汇编

`u [地址]`翻译成汇编指令


`mount c o:masm`将c挂载到指定路径
`c:`进入c
`dir`查看文件ls
``

### 地址

格式：段地址:偏移地址

## 基础指令

### 段定义+Assume





### 数据定义



### MOV

`MOV a,b` 将b的数据移到a
相当于`a=b`

CH是CX中较高的2个16进制位
ah是AX中较高的2个16进制位
bl是BX中较低的2个16进制位  

### add

`add a,b`将b加给a，相当于`a+=b`

**如果指定了高位或者低位**，那么寄存器中的高位和低位是独立的，也就是当低位发生溢出时，溢出的数字不会加到高位上

### sub

`sub a,b`将a减去b，相当于`a-=b`

 负溢出，把最高位的左边一位看成1，向其借1位

### mul

两个8位数相乘或两个16位数相乘

8位数：1个操作数默认放在al中
`mul bl`：将al与bl相乘后放在ax中

16位数：1个操作数默认放在AX中，另一个放在16位reg或内存单元
结果：高4位放在DX中，低4位放在AX中

### div

`div bl，div bx`

被除数：16位或者32位，默认存在AX或者DX+AX中 
除数：8位或者16位，在reg或内存单元中

16位 / 8位： `AX/BL = al……ah`，结果：AL存储商，AH存储余数
32位 / 16位：``DX+AX/BX = ax……dx `，结果：AX存储商，DX存储结果
可以看到，最终结果都覆盖掉了被除数的位置

### and/or 逻辑运算

`and/or al, xxB`逻辑运算后存到al中

### shi/shr/rol/ror 移位操作

`shi ax,1`左移或者右移 多少位 

`rol ax 1`循环左移/右移

###  rcl/rcr 带进位移位

### inc/dec ++ --

`inc ax`

### nop

空代码段，恰好占据一个字节

### xchg 交换

`xchg ax,bx`

### neg 取负数

`neg ax`

相当于按位取反再加1 



## 寄存器

| 名称           | 寄存器 | 含义          |
| -------------- | ------ | ------------- |
| 累加寄存器     | AX     | accumulator   |
| 基址寄存器     | BX     | base          |
| 计数寄存器     | CX     | count         |
| 数据寄存器     | DX     | data          |
|                |        |               |
| 堆栈指针寄存器 | SP     | Stack Pointer |
| 基址指针寄存器 | BP     | Base Pointer  |
| 源变址寄存器   | SI     | Source Index  |
|                | DI     |               |
| 指令指针寄存器 | IP     |               |
| 代码段寄存器   | CS     |               |
|                | DS     |               |
|                | SS     |               |
|                |        |               |



