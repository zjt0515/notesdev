## 概述



## CS方式和P2P方式

网络应用程序在各种端系统上的组织方式和他们之间的关系

- CS方式
- P2P方式

### CS方式

服务集中型，客户向服务器请求服务

- 客户和服务器指通信中的涉及的应用进程
- 进程之间服务和被服务的方式
- 客户是服务请求方，服务器是服务提供方
- 服务器总是处于运行状态，等待客户的服务请求，具有固定端口号



### P2P方式 

服务分散型

没有固定的服务请求者和服务提供者

应用进程是对等的，对等方之间直接进行通信

## 动态主机配置协议DHCP

作用：正确配置IP 子网掩码 默认网关 DNS服务器，但是手工配置容易出错，工作量大

### DHCP服务器和DHCP程序

用户主机通过DHCP程序向DHCP服务器请求配置，只需配置一次DHCP服务器即可

### DHCP工作过程

使用运输层UDP的服务，DHCP报文在运输层会被封装成为UDP用户数据报，在网络层进一步被封装为IP数据报，再根据网络接口封装成数据链路层的帧进行发送（例如以太网帧）

DHCP服务端(67) DHCP客户端(68)

1. 客户广播发送DHCP发现报文，源IP地址为0.0.0.0，目的地址为255.255.255.255
    广播发送：主机对DHCP服务器未知
    DHCP发现报文：封装有事物ID和DHCP客户端的MAC地址
2. 所有设备接受报文，层层解封
3. 服务端接收DHCP发现报文并作出响应，根据其中的MAC地址查找数据库
    使用ARP确保所选IP未被占用
    查询到配置信息，则构建发送DHCP提供报文
    反之，采用默认配置信息构建发送
    注：封装该报文的IP数据报的源地址为DHCP服务器IP，目的IP仍然为广播地址，因为客户还没有配置IP地址
4. 网络中所有设备收到IP数据报，层层解封，解封出封装有DHCP提供报文的UDP用户数据报
5.   DHCP客户端应用层运行着DHCP客户进程，会接受提供报文，根据其中的事物ID判断是否是自己请求的报文（与发现报文中的ID相等），否则丢弃，
6. 

## DNS

作用：存放域名和IP映射关系的服务器，将域名解析为IP地址

1. 用户主机在DNS高速缓存查找对应IP
2. 向网络中的某台DNS服务器查找
3.  DNS服务器接受DNS查询报文，查询数据库，返回结果



域名：层次结构的命名树 
DNS使大多数域名都在本地解析，少量解析需要在因特网上通信

### 域名结构

每一级域名：英文字母+数字，不超过63字符，不区分大小写

完整域名：不超过255字符

| ...                      | 三级域名 | 二级域名 | 顶级域名                          |
| ------------------------ | -------- | -------- | --------------------------------- |
| 由上一级域名管理机构管理 |          |          | 国家顶级域名：cn us uk            |
|                          |          |          | 通用顶级域名：com net org edu gov |
|                          |          |          | 反向域arpa，用于反向解析          |

> 名称相同的域名，等级不一定相同

### 域名服务器类型

root > top-level > Authoritative > local > caching

1. 13种根域名服务器：存储所有**顶级域名**服务器的域名及其IP，每台服务器是由分布各地的**服务器群集**构成：本地域名服务器向根域名服务器发送查询请求，路由器将请求报文转发到最近的根域名服务器
    通常不直接对域名解析，而是**返回顶级域名服务器的IP地址**
2. 顶级域名服务器：管理在该顶级域名服务器注册的**所有二级域名**，返回最后结果或者下一级权限域名服务器的IP地址
3. 权威性/权限域名服务器：负责管理某个区的域名，知道下级域名服务器的地址
4. 本地域名服务器（递归解析器？）：不属于上述域名服务器的等级结构，有缓存数据，或者依次向域名服务器发送请求

### 本地域名服务器

起代理作用，将报文转发到域名服务器等级结构

### 域名解析过程

1. 递归查询
2. 迭代查询

![image-20240924082829441](./images/image-20240924082829441.png)

高速缓存：存放最近查询过的域名，和从何处获得的记录 

高速缓存存在于本地域名服务器和用户主机中，用户主机在启动时从本地域名服务器下载数据库

> 保持高速缓存中内容的正确性：
>
> 每项内容设置计时器

> DNS查询次数：
>
> 对于abc.xyz.com，本地域名服务器发送的DNS查询次数0-4，
>
> 根域名、顶级域名.com、权限域名xyz.com、权限域名abc.xyz.com

### DNS报文

使用运输层的UDP协议封装，运输层端口号53

## 文件传送协议FTP

1. 提供交互式访问，允许客户指明文件类型格式，允许文件具有存取权限
2. 屏蔽计算机系统的细节，适合于在异构网络中任意计算机之间传送文件

### 访问ftp

命令行/ftp客户端

`ftp ip`

`dir`

`get 文件名`

`put 文件名`

### FTP工作原理

1. 控制连接：用于传送FTP控制命令，是由FTP客户发起的TCP连接
    随机端口号<=>熟知端口21
    会话期间一直打开
2. 数据连接：用于传输数据建立的TCP连接
    只有在文件传输时才会开启

主动模式和被动模式：主动被动是服务器主动被动

主动模式下，FTP使用熟知20端口来进行数据传输，由服务器发起TCP连接

被动模式下，使用随机临时端口号，由客户发起TCP连接

## 电子邮件



## 万维网WWW

大规模联机式的信息储藏所，一个分布式软件，**不是特殊的网络**

利用超链接将不同网页链接起来

浏览器内核不同，对网页内容的解析也不同，同一网页在不同内核的浏览器的显示效果可能不同

### 统一资源定位符URL

`<协议>://<主机>:<端口>/<路径>`

### 超文本传输协议HTTP
